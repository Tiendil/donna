
* TODO freeze pydantic models which are possible
* TODO codex should explain what it is doing, while executing requests from donna
* TODO complex story workflow
** TODO list based artifacts
*** TODO LIST artifacts with operations add, remove, replace
*** TODO iterate and groom over goals & objectives
*** TODO iterate over risks
*** TODO build plan from objectives and risks
*** TODO execute the plan by taking actions from the plan
** TODO graph-bases execution of the plan:
*** TODO buiild things-to-do by iterating over it in the contexts of objectives and risjs
*** TODO GRAPH(-LIST) artifacts with additiona operations to describe dependencies between list items
*** TODO build plan on top of things-to-do list
** TODO verify all risks are closed and rollback to planing if not
** TODO verify all objectives are met and rollback to planing if not
** TODO Split the whole worfklow into smaller scenarios/tasks?
** TODO prepare a report after the story is finished
** TODO custom command to run a specific subflow? Or whould we rest it to the agent? It look like agent can deside better, because otherwise we'll introduce a hard coupling between different flows.
** TODO replace "here is the beginning of the story specification" with an introspection of the records?
** TODO refactor records/kinds/items names, place them in order
* TODO tests
** TODO basic / lowest unit tests for primitive operations
** TODO domain-level unit tests
** TODO intergration tests for workflows/stories/scenarios
* TODO optimize imports by moving most used ones to \__init__.py files
* TODO `behavior` can be something on top of workflows. Maybe it be a constructor of workflows. I.e. user define own workflow by parametrizing them via `behavior`.
* TODO Objectives loop
** TODO Full spec on planing activities
** TODO Objectives grooming loop
*** choose unprocessed objective
*** groom objective
*** maybe via a single action request operation? With customized code for searching next objective to process
** TODO Goal-objective relations
** TODO Iterate goals into objectives
** TODO Full objective set grooming (may be moved into separate TODO list, since it may require planing)
** TODO Goals grooming (may be moved into separate TODO list, since it may require planing)
* TODO Do we need counters as a separate entity/config?
* TODO Records navigation + introspection
** TODO donna records ?extract? <kind*> <--property=>*
*** add <display/directive> as the global object that defines how to render the output
*** maybe display may be just jinja template?
*** dow we really need display? Maybe cells will be ok for technical output?
*** What we need:
**** select by kinds (and display kinds in order?)
**** filter by properties (better to have reach filtering syntax?)
**** run graph opertions on top of the result set? Or maybe just different <sort> operations?
** TODO replace partial description with new ?extract? command
** TODO Maybe we do not need kinds separate from records?
* TODO Consider using https://github.com/toon-format/toon for json formatting in cells
* TODO WE CAN ASK DONNA TO MAKE A FSM FOR DONNA!!! WHICH WILL BE OUR PLAN OF WORK!!!
* TODO virtual persona/roles as spects, so action request can tell whos role should be used to answer or agent could decide by itself
* TODO Lazy import of primitives from Python artifacts
** review
*** primitives module and std/*.py modules
*** donna.machine.artifacts
*** donna.world.worlds
*** donna.world.sources
*** remove artifact content classes from the world?
** replace artifact sections with primitives in the std/*.py modules?
*** primitive is semantically the same as artifact section, it just contains some meta info
*** this meta info is strongy coupled with the primitive instance
*** generally artifact section is 1:1 mapped to the primitive instance
** do we need `python_artifact_kind_section`?
** do we need a PrimarySection(ArtifactSection) class to simplify promary sections handling?
** introspection
*** !filesystem list artifacts does not find .py (uses hardcoded .md)
*** !remove _MARKDOWN_ROOTS
*** !list_artifact should be recursive?
*** ignore "session" from the artifacts? I.e. it is world.
**** place project and session worlds on the same level with config.toml?
**** remove session world, add session directory to the project world?
** replace donna imports with python imports?
** builtins
*** analogue of `__init__.py` for donna world for shorter ids/paths?
*** sections from world.builtings should be accessible by their ids without prefixes?
*** for directives
*** for kind ids
*** add `builtins: bool` into world config?
** python world implementation TODOs
*** split donna.machin.artifacts into submodules?
*** PythonModuleSectionMeta.attribute_value -> PythonModuleSectionMeta.entity
*** PythonArtifact -> PythonModuleArtifact
*** PythonModuleSectionKind.execut_section should work
*** Should we use PythonModuleSectionKind.construct_section to construct sections?
*** Should we use PythonArtifact.construct_artifact to construct artifacts?
*** refactor `PythonArtifact.construct_module`
** python world implementation, WANTs
*** world kinds are configured via python module imports (not artifact paths?) or somehow very smartly via artifact paths
*** system python (i.e. donna's environment) can be a world also with predefined behavior
**** so references to actual python modules should also work
*** move code.operations into submodules?
*** In case we implemen python modules as artifacts, section kind IDs should be full artifact-local IDs to the kind definition.
** introspection & discovery refactorings
*** artifacts listing/search functionality goest to the worlds
**** words should return standardized short info records about each artifact
**** and about each primitive (?) or should primitives be left for the donna side?
*** => introspection uses worlds to list available artifact/primitives
*** `donna artifacts list *` goest to `donna introspection`? or should be refactored into `artifacts search *`?
*** Each primitive should have a link to related specification or to the section in the specification?
*** In the context of all those changes, do we need namespaces for artifacts? Maybe we can live without them?
**** or without their current role in the code
*** mark artifacts and sections with tags to simplify filtering/searching
**** Do we need speciciations for tags? I.e. does tag a primitive?
*** tree-based artifacts discovery? I.e. folders with descriptions and folders as artifacts?
*** full ids for references to objects kinds
**** that'll allow to remove register in the honor of search in worlds
*** we may want to remove separation of artifacts by namespaces/directories
** Remove primitives registry completely?
** action request also could be an artifact?
** We may want to allow donna render part of artifact only (by section id)
** World kind that acts as a proxy to another donna project?
* unify code of different directives? It is very similar
** add validation for specificaiton existence in directives
** Spec rendere can be unified, since its cli command
* Artifact improvements:
** We may want, by default load/upload artifacts in a custom donna-managed directory, so, no filenames are needed for agents. This also will help to add right extensions automatically => help agents to anderstand internal formats.
** When we start the workflow, should we output the head cells before the first operation?
** do we need to explicitly reference `session.specification.work_scope.md` if its name has already specified in donna.specifications.planning?
** {{ edit(specification) }} directive?
** {{ run(workflow) }} directive?
** Improve planing instuction to explictitly polish list of items (goals, etc.) base on other items forward and backward.
** Declare explicit refining loop
** Add mini workflows to polish each kind of records?
** add tmp directory for intermediate artifacts? mayby in .donna/session/tmp/
** meta_work_loop.md contains a lot of repetitive commands to read specifications. We should optimize them somehow.
*** Approach 1: move them to the head section text
*** Approach 2: move them to the head section config
*** Approach 3: keep them, but add some meta info on analysis phase that donna can use.
** tune wording of workflows (what to write before goto)
** Planing loop improvement: before initial planing and on each loop try to found uncertain parts of tasks and ask developer to clarify them. Like in deep research.
** remove mention of <DONNA_CMD> from specs
** "Story" term still in some specs for convienience, we should think of a better naming
** currently we do not output the whole workflow body on the request of the artifact, only description. Maybe we should output the whole body?
** mention jinja comments {# ... #} in artifact specification
** artifact cli should always return Cells
* TODO Jinja2 improvements
** sandbox mode — do we need it?
** register jinja2 filters?
* TODO Organize standard cell kinds into enum (but allow custom kinds as well). Or just provide custom constructors for each use-case.
* TODO ask codex to straighten the naming/dictionary/terms in the donna project
** review the dictionary of primary terms
* TODO errors processing improvements
** Vebose jinja2 render errors to help agents and developers
** replace all NotImplementedError exceptions with custom exceptions and smart error handling
** exceptions must output cells?
** cleanup asserts — replace with real checks and exceptions
** rust-style errors?
* TODO Possible workflows
** bootstrap.bootstrap_all.
** bootstrap.donna.create_project
** bootstrap.donna.craete_specifications
** bootstrap.python.create_grooming_workflow
** bootstrap.python.create_project
** morphologica_analysis — workflow for explicit morphological analysis
** simple_task — workflow for simple tasks to not bother with complex story workflows
* TODO initialization of donna for the new project
** lack of donna project directory should not lead to exceptions or errors. Donna should try to locate the project directory with workflow from std world and if it is not initialized, it should offer to initialize it.
** create a copy of the default config for the new project
* TODO Grooming improvements
** Add spelling validation
** Add import/dependency flow restrictions (there were a specialized package for that)
* TODO integration into emacs? How?
** https://github.com/d12frosted/vui.el/
* TODO CLI operation
** Add a new operation kind, that runs cli commands as part of the workflow.
** The operation should not requre interaction with the agent or the user.
** Cli command
*** should start in the same environment as the donna runs
*** should be specified as a string and interpreted as a shell command, pipes are allowed
*** should be specified in a specialized code block
** We consider those commands save enough, because they will be defined in the workflows (i.e. reviewed by humans and agents).
** For this operation, specify next operations depending on the cli result code (as a map in the config block)
*** on success (zero code?)
*** on failure (none zero code?)
*** on specific code
** The next commands should be able to access the cli output (stdout and stderr) via variables.
*** Use WorkUnit context for this
** Update artifacts format specification with new operation info
* TODO We can track causality between artifact sections (what depends on what) as universal functionality of the artifact system. I.e. no need to introduce specialized relations for specialized artifacts.
* TODO interesting software to integrate with
** https://github.com/m0n0x41d/quint-code
** https://github.com/Fission-AI/OpenSpec
** https://www.reddit.com/r/PKMS/comments/1qdgr5a/would_a_simple_pkm_programming_language_make_sense/
* TODO README.md notes
** `No API keys required.` as a feature
** `save tokens by taking work from your agent to your code`
** compare to https://github.com/Fission-AI/OpenSpec
*** fsms instead of plain texts
*** "better" Markdown
* TODO lock for donna operations on the project
* TODO donna should be able to continue finished session (somewhow). I.e. when the developer ads new details to it.
* TODO Spec-based workflow (like in OpenSpec?)
* TODO add depenedency graph validation to the grooming (there are some python packages for that)
* TODO Request Action: agent has not always use the correctly specified branch, may be we should separate operation with next operation selection?
